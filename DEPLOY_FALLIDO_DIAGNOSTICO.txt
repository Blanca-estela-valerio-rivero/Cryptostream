â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                            â•‘
â•‘              ğŸ”´ DESPLIEGUE FALLIDO - DIAGNÃ“STICO Y SOLUCIÃ“N               â•‘
â•‘                                                                            â•‘
â•‘                    Sitio: snazzy-twilight-868202                           â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” DIAGNÃ“STICO DEL PROBLEMA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Posibles causas del fallo:

âŒ 1. VARIABLES DE ENTORNO NO AGREGADAS
   â””â”€ Sin PINATA_API_KEY y PINATA_SECRET_KEY, la app falla

âŒ 2. PROBLEMAS CON MONGODB LOCAL
   â””â”€ En Netlify no hay acceso a mongodb://localhost:27017
   â””â”€ SoluciÃ³n: Usar MongoDB Atlas (mongodb+srv://...)

âŒ 3. FALTA CREAR LA CARPETA "functions" EN EL REPO
   â””â”€ functions/api.js debe estar en la raÃ­z del repositorio

âŒ 4. COMANDOS DE BUILD INCORRECTOS
   â””â”€ El comando debe ser: cd backend && npm install

âŒ 5. PERMISOS O CONFIGURACIÃ“N DE GIT
   â””â”€ El repositorio debe permitir que Netlify lea los archivos


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… PASOS PARA SOLUCIONAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASO 1: Verificar que functions/api.js existe en el repo
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Tu estructura debe ser:

CRYPTOSTREAM/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ index.js
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ services/
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ public/
â”‚       â””â”€â”€ index.html
â”œâ”€â”€ functions/          â† Â¡DEBE EXISTIR!
â”‚   â””â”€â”€ api.js          â† Â¡DEBE EXISTIR!
â”œâ”€â”€ netlify.toml
â””â”€â”€ .env


PASO 2: Verificar que functions/api.js estÃ¡ configurado correctamente
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

El archivo debe contener:

```javascript
const serverless = require('serverless-http');
const app = require('../backend/index');

const handler = serverless(app);
module.exports = { handler };
```


PASO 3: Verificar netlify.toml
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Debe tener:

[build]
  publish = "frontend/public"
  command = "cd backend && npm install"
  functions = "functions"
  node_version = "18.17.0"


PASO 4: Agregar variables de entorno en Netlify Dashboard
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Ve a: https://app.netlify.com
2. Selecciona: snazzy-twilight-868202
3. Settings â†’ Build & deploy â†’ Environment
4. Click: "Edit variables"
5. Agrega las 5 variables:

   PINATA_API_KEY        = 25038791f137b293b9e8
   PINATA_SECRET_KEY     = 25038791f137b293b9e8
   MONGODB_URI           = mongodb://localhost:27017/cryptostream
   STELLAR_NETWORK       = TESTNET
   PORT                  = 3000

6. Click: "Save"


PASO 5: Hacer redeploy
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. En Netlify Dashboard
2. Ve a: Deploys
3. Selecciona el Ãºltimo deploy
4. Click: "Retry build"
   O simplemente: haz un push a GitHub (rama Blanca)


PASO 6: Verificar logs
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Dashboard â†’ Deploys â†’ Tu deploy
2. Click: "View deploy log"
3. Busca errores en rojo
4. Si ves "Cannot find module 'serverless-http'"
   â†’ El npm install no funcionÃ³ correctamente


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âš ï¸ PROBLEMA PROBABLE: MONGODB LOCAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

La URL mongodb://localhost:27017/cryptostream SOLO funciona en tu mÃ¡quina local.

En Netlify NO EXISTE "localhost" porque es un servidor diferente.

SOLUCIÃ“N: Cambiar a MongoDB Atlas (gratis)

1. Ve a: https://www.mongodb.com/cloud/atlas
2. Crea cuenta (gratis)
3. Crea cluster gratuito
4. ObtÃ©n connection string: mongodb+srv://usuario:password@cluster.mongodb.net/cryptostream
5. En Netlify Dashboard, actualiza MONGODB_URI con esa URL


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”§ ARCHIVO functions/api.js (DEBE EXISTIR)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Si NO EXISTE, crÃ©alo con este contenido:

Archivo: c:\Users\Estela\Desktop\CRYPTOSTREAM\functions\api.js

```javascript
/**
 * Netlify Serverless Function para CryptoStream
 * 
 * Esta funciÃ³n expone el backend Express como una funciÃ³n serverless en Netlify.
 * La redirecciÃ³n de /api/* a /.netlify/functions/api/:splat se configura en netlify.toml
 * 
 * Importante: AsegÃºrate de que todas las variables de entorno estÃ©n configuradas en Netlify
 */

const serverless = require('serverless-http');
const app = require('../backend/index');

// ConfiguraciÃ³n de la funciÃ³n serverless
const handler = serverless(app, {
    // Request context
    request: (request, event, context) => {
        // Logging para debugging
        console.log(`[Netlify Function] ${request.method} ${request.path}`);
    },
    // Response context
    response: (response, event, context) => {
        // Logging de respuestas
        console.log(`[Netlify Function] Respuesta: ${response.statusCode}`);
    }
});

module.exports = { handler };
```


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ CHECKLIST DE VERIFICACIÃ“N
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Local:
  [ ] functions/api.js existe
  [ ] netlify.toml estÃ¡ correcto
  [ ] backend/package.json tiene serverless-http
  [ ] .env tiene todas las variables

GitHub (Blanca):
  [ ] functions/api.js estÃ¡ pusheado
  [ ] netlify.toml estÃ¡ pusheado
  [ ] backend/package.json estÃ¡ pusheado
  [ ] .env NO estÃ¡ pusheado (.gitignore protege)

Netlify Dashboard:
  [ ] 5 variables de entorno agregadas
  [ ] Build command: cd backend && npm install
  [ ] Publish directory: frontend/public
  [ ] Functions directory: functions
  [ ] Node version: 18.17.0

MongoDB:
  [ ] Si usas local: solo funciona en desarrollo
  [ ] Para Netlify: cambiar a MongoDB Atlas


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ PRÃ“XIMO PASO: HACER PUSH Y REDEPLOY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. AsegÃºrate que todo estÃ¡ en GitHub (rama Blanca)
2. Ve a Netlify Dashboard
3. Settings â†’ Build & deploy â†’ Environment
4. Agrega las 5 variables (si no las has agregado)
5. Haz un push a GitHub o click "Retry build"
6. Espera a que compile
7. Revisa los logs si hay errores


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â“ ERRORES COMUNES Y SOLUCIONES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ERROR: "Cannot find module 'serverless-http'"
â””â”€ SoluciÃ³n: npm install en backend debe haber agregado serverless-http
â””â”€ Verificar: backend/package.json tiene "serverless-http": "^3.2.0"

ERROR: "Cannot find module '../backend/index'"
â””â”€ SoluciÃ³n: functions/api.js intenta importar backend/index.js
â””â”€ Verificar: Ruta correcta y que archivo existe

ERROR: "PINATA_API_KEY is undefined"
â””â”€ SoluciÃ³n: No agregaste variables en Netlify Dashboard
â””â”€ AcciÃ³n: Ve a Settings â†’ Build & deploy â†’ Environment â†’ Agrega variables

ERROR: "MongoDB connection failed"
â””â”€ SoluciÃ³n: mongodb://localhost:27017 no funciona en Netlify
â””â”€ AcciÃ³n: Cambiar a MongoDB Atlas

ERROR: "Cannot GET /api/videos"
â””â”€ SoluciÃ³n: Redirects en netlify.toml incorrectos
â””â”€ Verificar: /api/* debe venir ANTES de /*


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ INFORMACIÃ“N DEL DEPLOY FALLIDO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Sitio: snazzy-twilight-868202
Repositorio: Blanca-estela-valerio-rivero/Cryptostream
Rama: Blanca
Build command: cd backend && npm install
Publish: frontend/public
Functions: functions

Variables configuradas: â“ (revisar en Dashboard)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… UNA VEZ QUE FUNCIONE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Tu aplicaciÃ³n estarÃ¡ en:

ğŸŒ Frontend:     https://snazzy-twilight-868202.netlify.app
ğŸ“¹ API Videos:   https://snazzy-twilight-868202.netlify.app/api/videos
ğŸ’Š Health:       https://snazzy-twilight-868202.netlify.app/api/health


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Documento creado: 3 de diciembre de 2025
Revisar logs en: https://app.netlify.com
